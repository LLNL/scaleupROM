main:
#mode: run_example/sample_generation/build_rom/single_run
  mode: single_run
  use_rom: true
  solver: stokes

mesh:
  type: component-wise
  component-wise:
# you can try other config files you generated by specifying it here.
    global_config: "configs/test.box-channel.8x8.h5"
    components:
      - name: "empty"
        file: "meshes/square.o3.mesh"
      - name: "square-circle"
        file: "meshes/square-circle.msh.mfem"
      - name: "square-square"
        file: "meshes/square-square.msh.mfem"
      - name: "square-triangle"
        file: "meshes/square-triangle.msh.mfem"
      - name: "square-star"
        file: "meshes/square-star.msh.mfem"

domain-decomposition:
  type: interior_penalty

discretization:
  order: 2
  full-discrete-galerkin: false

solver:
  direct_solve: true
  use_amg: true
  max_iter: 1000000
  print_level: 0
  absolute_tolerance: 1.0e-10
  relative_tolerance: 1.0e-10

visualization:
  enabled: true
  visualize_error: true
  unified_paraview: false
  file_path:
    prefix: paraview/8x8/stokes_array_output

parameterized_problem:
  name: flow_past_array
  #name: stokes_channel

single_run:
  choose_from_random_sample: false
  flow_past_array:
    nu: 1.1
    u0_x: 1.5
    u0_y: -0.8
    du_x: 0.
    du_y: 0.
  stokes_channel:
    nu: 1.1
    U: 1.5
    L: 4.
    x0: 2.

sample_generation:
  type: "random"
  random_sample_generator:
    number_of_samples: 100
  maximum_number_of_snapshots: 100
  parameters:
    - key: mesh/component-wise/global_config
      type: filename
      minimum: 0
      maximum: 99
      format: "boxchannel_sample/8x8_samples/box-channel.8x8.%06d.h5"
    - key: single_run/flow_past_array/u0_x
      type: double
      minimum: -1.5
      maximum: 1.5
    - key: single_run/flow_past_array/u0_y
      type: double
      minimum: -1.5
      maximum: 1.5

basis:
  prefix: "basis/stokes_basis"
  number_of_basis: 36
  tags:
    - name: "empty"
    - name: "square-circle"
    - name: "square-square"
    - name: "square-triangle"
    - name: "square-star"
  svd:
    save_spectrum: true
    update_right_sv: false
  visualization:
    enabled: false
    prefix: stokes_comp

model_reduction:
  rom_handler_type: mfem
  linear_solver_type: direct
  linear_system_type: spd
# This is the input for saving ROM matrix/rhs system.
  save_linear_system:
    enabled: true
    prefix: rom-system/stokes.8x8
  preconditioner: gs
  # individual/universal
  subdomain_training: universal
  save_operator:
    level: component
    prefix: "stokes_comp"
  compare_solution:
    enabled: true

